(function(){function a(a){return Object.prototype.toString.call(a)}function b(b){return a(b)==="[object Array]"}function c(b){return a(b)==="[object String]"}function d(a,b){for(var c=0;c<a.length;c++){a[c]=b(a[c])}return a}function e(a,b,c){while(a.length<b){a=c+a}return a}function f(a){var b,c,d,e=a[0],f=a[1],g=a[2],h=Math.floor(e*6),i=e*6-h,j=g*(1-f),k=g*(1-i*f),l=g*(1-(1-i)*f);switch(h%6){case 0:b=g,c=l,d=j;break;case 1:b=k,c=g,d=j;break;case 2:b=j,c=g,d=l;break;case 3:b=j,c=k,d=g;break;case 4:b=l,c=j,d=g;break;case 5:b=g,c=j,d=k;break}return[Math.floor(b*255),Math.floor(c*255),Math.floor(d*255),1]}function g(a){var b=a[0]/255,c=a[1]/255,d=a[2]/255,e=Math.max(b,c,d),f=Math.min(b,c,d),g=0,h=e,i=e-f,j=e==0?0:i/e;if(e==f){g=0}else{switch(e){case b:g=(c-d)/i+(c<d?6:0);break;case c:g=(d-b)/i+2;break;case d:g=(b-c)/i+4;break}g/=6}return[g,j,h]}function h(a){return e(a[0].toString(16),2,"0")+e(a[1].toString(16),2,"0")+e(a[2].toString(16),2,"0")}function i(a){a=l(a);return[parseInt(a.substr(0,2),16),parseInt(a.substr(2,2),16),parseInt(a.substr(4,2),16)]}function j(a){a.pop();return a}function k(a){if(a.length==3){a.push(1)}return a}function l(a){a=a[0]=="#"?a.substring(1):a;return a.length==3?a[0]+a[0]+a[1]+a[1]+a[2]+a[2]:a}this.Color=function(a){this.set(a)};Color.hsvToRgba=f;Color.rgbToHsv=g;Color.rgbToHex=h;Color.hexToRgba=i;Color.rgbaToRgb=j;Color.rgbToRgba=k;Color.fixHex=l;Color.prototype={rgba:[],getRgb:function(){var a=this.getRgba();if(a){return a.slice(0,3)}else{return null}},getRgba:function(){return this.rgba||null},getHex:function(a){var b=this.getRgb();return b===null?null:(a===true?"#":"")+h(b)},getHsv:function(){var a=this.getRgb();return a===null?null:g(a)},set:function(a){if(a&&(a.hsv||a.rgb||a.rgba||a.hex)){if(a.hsv){this.rgba=f(a.hsv)}else if(a.rgb){this.rgba=k(a.rgb)}else if(a.rgba){this.rgba=a.rgba}else if(a.hex){this.rgba=i(a.hex)}}else if(b(a)){this.rgba=k(a)}else if(c(a)){if(a[0]=="r"){if(a[3]!="a"){this.rgba=d(k(a.substring(4,a.length-1).split(",")),function(a){return+a})}else{this.rgba=d(a.substring(5,a.length-1).split(","),function(a){return+a})}}else{this.rgba=i(a)}}else{this.rgba=[255,255,255,1]}return this}}}).call(this)